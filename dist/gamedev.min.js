!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.gamedevjs=e():t.gamedevjs=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.events={},this.onceList=[]}return t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=this.events[t];if(i)for(var r=0,s=i;r<s.length;r++){var o=s[r];o.apply(o,e),this.onceList.indexOf(t)>=0&&this.unregister(t)}},t.prototype.register=function(t,e,n){void 0===n&&(n=!1),this.events[t]&&!n||(this.events[t]=[]),this.events[t].push(e)},t.prototype.registerOnce=function(t,e,n){void 0===n&&(n=!1),this.register(t,e,n),this.onceList.indexOf(t)<0&&this.onceList.push(t)},t.prototype.unregister=function(t){this.events[t]=[]},t.prototype.unregisterList=function(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];this.unregister(i)}},t.prototype.unregisterCallback=function(t,e){var n=this.events[t];if(n)for(var i=0;i<n.length;i++)if(event===e){n.splice(i,1);break}},t.prototype.unregisterAll=function(){this.events={},this.onceList=[]},t}();e.EventManager=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventStatus={ASYNC:"async",CANCEL:"cancel",CONTINUE:"continue"};var i=function(){function t(){this.events={},this.current=""}return t.prototype.setInitState=function(t){this.current=t},t.prototype.runEvent=function(t,e,n){if(this.events[""+t+e]&&this.events[""+t+e].call)return this.events[""+t+e](n)},t.prototype.processEvent=function(t){var n=this,i=t.shift(),r=!0,s=!1,o=function(){r&&(n.processEvent(t),s=!0)};if(i){switch(i(o)){case e.EventStatus.CANCEL:r=!1;break;case e.EventStatus.ASYNC:break;default:r=!1,s||this.processEvent(t)}}},t.prototype.pushEvents=function(t){var e=this,n=this;for(var i in t)!function(i){if(t.hasOwnProperty(i)){var r=t[i];n.events[i]=function(){(e.current===r.from||r.from.indexOf(e.current)>=0)&&e.processEvent([function(t){return e.runEvent("before","any",t)},function(t){return e.runEvent("before",i,t)},function(t){return e.runEvent("leave",e.current,t)},function(t){return e.runEvent("leave","any",t)},function(t){e.current=r.to,t()},function(t){return e.runEvent("enter","any",t)},function(t){return e.runEvent("enter",e.current,t)},function(t){return e.runEvent("after",i,t)},function(t){return e.runEvent("after","any",t)}])}}}(i)},t}();e.FiniteStateMachine=i;var r=function(){function t(){}return t.prototype.config=function(t){var e=new i;return e.setInitState(t.initial||""),e.pushEvents(t.events||{}),e},t}();e.FiniteStateMachineStatic=r},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.items=[]}return t.prototype.cloneItem=function(t){if(t)return i({},t)},t.prototype.getItem=function(){var t=this.items.shift();if(!t&&this.sample&&(t=this.cloneItem(this.sample)),t)return t.__alive=!0,this.onget(t),t},t.prototype.pushItem=function(t){t.__alive=!1,this.onpush(t),this.items.push(t)},t.prototype.setItems=function(t){this.items=t},t.prototype.clear=function(){this.items=[]},t.prototype.returnItem=function(t){t.__alive=!1,this.onreturn(t),this.items.push(t)},t.prototype.generateItems=function(t,e){if(this.sample=t,t&&e)for(var n=0;n<e;n++){var i=this.cloneItem(this.sample);this.items.push(i)}},t}();e.Pool=r;var s=function(){function t(){}return t.prototype.config=function(t){var e=new r;return e.onreturn=t.onreturn||function(){},e.onget=t.onget||function(){},e.onpush=t.onpush||function(){},e.setItems(t.items||[]),e.generateItems(t.sampleItem,t.sampleCount),e},t}();e.PoolStatic=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.endTime=0,this.steps=[],this.startTime=0,this.isRunning=!1,this.timeouts=[],this.delay=0,this.repeat=0}return t.prototype.start=function(t,e){var n=this;void 0===t&&(t=0),void 0===e&&(e=0),this.stop(),this.delay=void 0!==t?t:this.delay,this.repeat=void 0!==e?e:this.repeat,this.isRunning=!0,this.endTime=0;for(var i=this,r=0,s=this.steps;r<s.length;r++){var o=s[r];!function(t){var e=setTimeout(function(){n.isRunning&&t.run()},i.delay+t.at),r=t.duration||0;i.endTime=Math.max(i.endTime,i.delay+t.at+r),i.timeouts.push(e)}(o)}this.scheduleEndStep(),this.startTime=Date.now()},t.prototype.scheduleEndStep=function(){var t=this,e=setTimeout(function(){t.repeat=t.repeat>0?t.repeat-1:t.repeat,t.repeat>0||-1===t.repeat?t.start():t.stop()},this.endTime+1);this.timeouts.push(e)},t.prototype.stop=function(t){if(void 0===t&&(t=!0),this.isRunning=!1,t)for(var e=0,n=this.timeouts;e<n.length;e++){var i=n[e];clearTimeout(i)}this.timeouts=[],this.startTime=0},t.prototype.pushStep=function(t,e){var n={at:t,run:e};this.steps.push(n),this.scheduleNewStep(n)},t.prototype.scheduleNewStep=function(t){var e=Date.now()-this.startTime;if(t.at>e){var n=setTimeout(t.run,t.at-e);this.timeouts.push(n);var i=t.duration||0,r=t.at-e+i;if(t.at>this.endTime){if(this.timeouts.length>1){var s=this.timeouts.splice(this.timeouts.length-2,1)[0];clearTimeout(s)}this.endTime=r,this.scheduleEndStep()}}},t.prototype.pushSteps=function(t){if(t&&t.length){this.steps=this.steps.concat(t);for(var e=0,n=t;e<n.length;e++){var i=n[e];this.scheduleNewStep(i)}}},t.prototype.pushDurationSteps=function(t){for(var e=0,n=0,i=t;n<i.length;n++){var r=i[n],s={at:e,run:r.run};e+=r.duration,this.steps.push(s),this.scheduleNewStep(s)}},t}();e.Scheduler=i;var r=function(){function t(){}return t.prototype.config=function(t){var e=new i;return e.pushSteps(t),e},t.prototype.sequence=function(t){var e=new i;return e.pushDurationSteps(t),e},t}();e.SchedulerStatic=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),r=n(1);e.EventStatus=r.EventStatus;var s=n(2),o=n(0);e.EventManager=o.EventManager;var u=function(){function t(){this.scheduler=new i.SchedulerStatic,this.fsm=new r.FiniteStateMachineStatic,this.pool=new s.PoolStatic,this.event=new o.EventManager}return t}();e.GameDev=u;var a=new u;e.gamedev=a;var c={gamedev:a,EventStatus:r.EventStatus,EventManager:o.EventManager};window&&(window.gamedevjs=c)}])});